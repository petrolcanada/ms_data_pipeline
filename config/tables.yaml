# Snowflake Table Sync Configuration
tables:
  - name: "FUND_SHARE_CLASS_BASIC_INFO_CA_OPENEND"
    snowflake:
      database: "CIGAM_PRD_RL"
      schema: "MORNINGSTAR_MAIN"
      table: "FUND_SHARE_CLASS_BASIC_INFO_CA_OPENEND"
      # Optional: Filter data during export
      # Single filter (string):
      # filter: "WHERE SECID IN (SELECT SECID FROM CIGAM_PRD_RL.MORNINGSTAR_MAIN.VW_ACTIVE_FUNDS)"
      
      # Multiple filters (list) - recommended for complex conditions:
      filter:
        - "where _id in (select mstarid from CIGAM_SBX_PL.DNA_ANALYTICS_INSIGHTS_INVESTMENT_PRODUCT.V_MSTAR_PEERS_FCLASS_ETF_ID_CA_OPENEND)"
        # - "AND _TIMESTAMPTO LIKE '%9999%'"
    postgres:
      schema: "ms"
      table: "FUND_SHARE_CLASS_BASIC_INFO_CA_OPENEND"
    sync_mode: "full"
    schedule: "daily"
    encryption: true
    compression: true
    # Optional: Customize for this specific table
    # export:
    #   chunk_size: 50000         # Smaller chunks for this table
    # import:
    #   batch_size: 5000          # Smaller batches for this table

  - name: "FUND_ATTRIBUTES_CA_OPENEND"
    snowflake:
      database: "CIGAM_PRD_RL"
      schema: "MORNINGSTAR_MAIN"
      table: "FUND_ATTRIBUTES_CA_OPENEND"
      # Optional: Filter data during export
      # Single filter (string):
      # filter: "WHERE SECID IN (SELECT SECID FROM CIGAM_PRD_RL.MORNINGSTAR_MAIN.VW_ACTIVE_FUNDS)"
      
      # Multiple filters (list) - recommended for complex conditions:
      filter:
        - "where _id in (select mstarid from CIGAM_SBX_PL.DNA_ANALYTICS_INSIGHTS_INVESTMENT_PRODUCT.V_MSTAR_PEERS_FCLASS_ETF_ID_CA_OPENEND)"
        - "AND _TIMESTAMPTO LIKE '%9999%'"
    postgres:
      schema: "ms"
      table: "FUND_SHARE_CLASS_BASIC_INFO_CA_OPENEND"
    sync_mode: "full"
    schedule: "daily"
    encryption: true
    compression: true
    # Optional: Customize for this specific table
    # export:
    #   chunk_size: 50000         # Smaller chunks for this table
    # import:
    #   batch_size: 5000          # Smaller batches for this table



# SELECT *
# FROM CIGAM_PRD_RL.MORNINGSTAR_MAIN.MONTH_END_TRAILING_TOTAL_RETURNS_CA_OPENEND
# WHERE 1=1
# AND _ID IN (select mstarid from CIGAM_SBX_PL.DNA_ANALYTICS_INSIGHTS_INVESTMENT_PRODUCT.V_MSTAR_PEERS_FCLASS_ETF_ID_CA_OPENEND)
# QUALIFY ROW_NUMBER() OVER (PARTITION BY _ID, MONTHENDDATE ORDER BY _TIMESTAMPTO DESC) = 1
# ORDER BY MONTHENDDATE DESC
# LIMIT 1000;